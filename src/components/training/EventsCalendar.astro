---
/**
 * EventsCalendar.astro
 * Full events calendar for /training/events page
 * Can be extended with filtering, search, and pagination
 */
import EventCard from '../cards/EventCard.astro';

// Full event list - can be loaded from data source in future
const allEvents = [
  {
    isLive: true,
    month: 'NOW',
    type: 'workshop' as const,
    name: 'Building AI Agents with LangChain',
    speaker: 'Sarah Kim · Spotify',
    watching: '127 watching'
  },
  {
    month: 'FEB',
    day: '06',
    type: 'talk' as const,
    name: 'Zero-Downtime Deployments at Scale',
    speaker: 'Jake Davidson · AWS',
    time: '2:00 PM EST'
  },
  {
    month: 'FEB',
    day: '10',
    type: 'hackathon' as const,
    name: '48hr AI Hackathon: Build the Future',
    speaker: 'Community Event',
    attendees: '342 registered'
  },
  {
    month: 'FEB',
    day: '15',
    type: 'workshop' as const,
    name: 'Advanced TypeScript: Generics & Patterns',
    speaker: 'Marcus Chen · Stripe',
    time: '6:00 PM EST'
  }
];
---

<section class="events-calendar" id="events">
  <div class="events-atmosphere">
    <div class="e-orb e-orb-1"></div>
  </div>

  <div class="events-container">
    <div class="events-layout">
      <div class="events-left">
        <span class="section-tag">
          <span class="tag-dot"></span>
          <span class="tag-code">events.upcoming()</span>
        </span>
        <h2 class="events-title">
          Never stop
          <span class="title-accent">learning</span>
        </h2>
        <p class="events-subtitle">
          Live workshops, hackathons, conferences, and study groups happening every week. All free for members.
        </p>

        <div class="events-stats">
          <div class="e-stat">
            <span class="e-stat-value">50+</span>
            <span class="e-stat-label">Events/year</span>
          </div>
          <div class="e-stat-divider"></div>
          <div class="e-stat">
            <span class="e-stat-value">4.9</span>
            <span class="e-stat-label">Avg rating</span>
          </div>
          <div class="e-stat-divider"></div>
          <div class="e-stat">
            <span class="e-stat-value">Free</span>
            <span class="e-stat-label">For members</span>
          </div>
        </div>

        <!-- Future: Add filters/search here -->
        <!-- <div class="events-filters">
          <button>All Events</button>
          <button>Workshops</button>
          <button>Hackathons</button>
          <button>Tech Talks</button>
        </div> -->
      </div>

      <div class="events-right">
        <div class="events-list" id="events-list">
          {allEvents.map((event) => <EventCard event={event} />)}
        </div>

        <!-- Future: Add pagination or "Load More" -->
        <!-- <div class="events-pagination">
          <button>Load More Events</button>
        </div> -->
      </div>
    </div>
  </div>
</section>

<script>
document.addEventListener('DOMContentLoaded', () => {
  const cards = document.querySelectorAll('[data-event]');
  const observer = new IntersectionObserver((entries) => {
    entries.forEach((entry) => {
      if (entry.isIntersecting) {
        entry.target.classList.add('visible');
        observer.unobserve(entry.target);
      }
    });
  }, { threshold: 0.15 });
  cards.forEach((card, i) => {
    (card as HTMLElement).style.transitionDelay = `${i * 0.1}s`;
    observer.observe(card);
  });
});
</script>

<style>
  .events-calendar {
    position: relative;
    padding: 120px 0;
    overflow: hidden;
    z-index: 1;
  }

  .events-atmosphere {
    position: absolute;
    inset: 0;
    pointer-events: none;
  }

  .e-orb {
    position: absolute;
    border-radius: 50%;
    filter: blur(120px);
  }

  .e-orb-1 {
    top: 20%;
    right: -10%;
    width: 600px;
    height: 600px;
    background: radial-gradient(circle, rgba(var(--cyan-400-rgb), 0.08) 0%, transparent 70%);
    animation: eFloat 22s ease-in-out infinite;
  }

  @keyframes eFloat {
    0%, 100% { transform: translate(0, 0); }
    50% { transform: translate(-30px, 20px); }
  }

  .events-container {
    position: relative;
    z-index: 2;
    margin: 0 auto;
    padding: 0 48px;
  }

  /* Layout */
  .events-layout {
    display: grid;
    grid-template-columns: 1fr 1.3fr;
    gap: 64px;
    align-items: start;
    max-width: 1400px;
    margin: 0 auto;
  }

  /* Left */
  .events-left {
    position: sticky;
    top: 120px;
  }

  .section-tag {
    display: inline-flex;
    align-items: center;
    gap: 8px;
    padding: 6px 16px;
    background: var(--bg-secondary);
    border: 1px solid var(--border);
    border-radius: 100px;
    font-size: 12px;
    font-weight: 600;
    color: var(--accent);
    margin-bottom: 20px;
    font-family: var(--font-code);
  }

  .tag-dot {
    width: 6px;
    height: 6px;
    background: var(--accent);
    border-radius: 50%;
    animation: tagPulse 2s ease-in-out infinite;
  }

  @keyframes tagPulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.4; } }

  .events-title {
    font-family: var(--font-display);
    font-size: clamp(2rem, 3.5vw, 3rem);
    font-weight: 700;
    letter-spacing: -0.03em;
    color: var(--text);
    margin-bottom: 16px;
    line-height: 1.15;
  }

  .title-accent {
    background: var(--gradient);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
  }

  .events-subtitle {
    font-size: 15px;
    color: var(--text-secondary);
    line-height: 1.7;
    margin-bottom: 32px;
    font-family: var(--font-display);
  }

  .events-stats {
    display: flex;
    align-items: center;
    gap: 20px;
    margin-bottom: 32px;
    padding: 20px;
    background: var(--bg-card);
    border: 1px solid var(--border);
    border-radius: 16px;
  }

  .e-stat { text-align: center; flex: 1; }

  .e-stat-value {
    display: block;
    font-family: var(--font-display);
    font-size: 22px;
    font-weight: 700;
    color: var(--text);
    letter-spacing: -0.02em;
  }

  .e-stat-label {
    font-size: 11px;
    color: var(--text-muted);
  }

  .e-stat-divider {
    width: 1px;
    height: 32px;
    background: var(--border);
    flex-shrink: 0;
  }

  /* Events List */
  .events-list {
    display: flex;
    flex-direction: column;
    gap: 12px;
  }

  /* Responsive */
  @media (max-width: 1024px) {
    .events-layout {
      grid-template-columns: 1fr;
      gap: 40px;
    }
    .events-left {
      position: static;
      text-align: center;
    }
    .events-stats { justify-content: center; }
  }

  @media (max-width: 768px) {
    .events-calendar { padding: 80px 0; }
    .events-container { padding: 0 20px; }
    .events-layout { max-width: none; }
  }
</style>
